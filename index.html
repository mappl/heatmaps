<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8" />
    <title> </title>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="ext/leaflet-src.js"></script>
    <link rel="stylesheet" href="ext/leaflet.css" />    
<!-- wms -->
    <script src="ext/leaflet.wms.js"></script>
<!-- pkk -->    
    <script src="ext/leaflet.TileLayer.Rosreestr.js"></script>    
<!-- scalebar -->
    <script src="ext/leaflet.edgescalebar.js"></script>
    <link rel="stylesheet" href="ext/leaflet.control.mousePosition.css">
<!-- heatmap js -->
    <script src="ext/heatmap.js"></script>
    <script src="ext/leaflet-heatmap.js"></script>
<!-- heatmap data -->
    <script src="data/heatdata.js"></script>
<!-- ya maps -->
    <!--script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&amp;apikey=75780e21-1d3e-4aa2-b14e-1a99a3f4e6d9" type="text/javascript"></script>
    <script src="ext/leaflet.layer.Yandex.min.js">
    </script-->
    
    <script>
      $( window ).on( "load", function() {
        
        var osm = L.tileLayer(
          'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
            attribution: '...',
            maxZoom: 18
          }
        );
        
        var esriSattelite = L.tileLayer(
          'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',{
            attribution: 'esri',
            maxZoom: 18
          }
        );
        
        var googleSattelite = L.tileLayer(
          'http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
            subdomains:['mt0','mt1','mt2','mt3']},{
            attribution: 'Google-Satellite',
            maxZoom: 18
          }
        );
        
       var cadastre = L.tileLayer.Rosreestr(
        'https://pkk.rosreestr.ru/arcgis/rest/services/PKK6/Cadastre/MapServer/export?layers%3Dshow%3A21&dpi=96&format=PNG32&bboxSR=102100&imageSR=102100&size=1024%2C1024&transparent=true&f=image&bbox={bbox}', {
          tileSize: 1024,
          attribution: 'Rosreestr'
       });        
/*        
        var yandexVector = L.yandex();     
        var yandexSatellite = L.yandex({ type: 'satellite' });
*/        
        
        var can_r7 = new HeatmapOverlay({
            "radius": 3.5/*0.00015259021896696422*/,
            "maxOpacity": .5,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'y',
            "lngField": 'x',
            "valueField": 'Наполненность бункера',
            "gradient": { 
              0.001: 'black',
              0.05: 'blue',
              0.25: 'cyan', 
              0.5: 'green', 
              0.75: 'yellow', 
              1: 'red'}
        });
                
        var can_r13 = new HeatmapOverlay({
            "radius": 3.5/*0.00015259021896696422*/,
            "maxOpacity": .5,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'y',
            "lngField": 'x',
            "valueField": 'Зазор решето нижнее',
            "gradient": { 
              0.001: 'black',
              0.05: 'blue',
              0.25: 'cyan', 
              0.5: 'green', 
              0.75: 'yellow', 
              1: 'red'}
        });

        var can_r14 = new HeatmapOverlay({
            "radius": 3.5/*0.00015259021896696422*/,
            "maxOpacity": .5,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'y',
            "lngField": 'x',
            "valueField": 'Зазор решето верхнее',
            "gradient": { 
              0.001: 'black',
              0.05: 'blue',
              0.25: 'cyan', 
              0.5: 'green', 
              0.75: 'yellow', 
              1: 'red'}
        });

        var can16bitr12 = new HeatmapOverlay({
            "radius": 3.5/*0.00015259021896696422*/,
            "maxOpacity": .5,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'y',
            "lngField": 'x',
            "valueField": 'Поток зерна',
            "gradient": { 
              0.001: 'black',
              0.05: 'blue',
              0.25: 'cyan', 
              0.5: 'green', 
              0.75: 'yellow', 
              1: 'red'}
        });
        
        var can16bitr15 = new HeatmapOverlay({
            "radius": 3.5/*0.00015259021896696422*/,
            "maxOpacity": .5,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'y',
            "lngField": 'x',
            "valueField": 'Влажность',
            "gradient": { 
              0.001: 'black',
              0.05: 'blue',
              0.25: 'cyan', 
              0.5: 'green', 
              0.75: 'yellow', 
              1: 'red'}
        });
        
        var can8bitr18 = new HeatmapOverlay({
            "radius": 3.5/*0.00015259021896696422*/,
            "maxOpacity": .5,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'y',
            "lngField": 'x',
            "valueField": 'Бункер',
            "gradient": { 
              0.001: 'black',
              0.05: 'blue',
              0.25: 'cyan', 
              0.5: 'green', 
              0.75: 'yellow', 
              1: 'red'}
        });
        
        var can8bitr26 = new HeatmapOverlay({
            "radius": 3.5/*0.00015259021896696422*/,
            "maxOpacity": .5,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'y',
            "lngField": 'x',
            "valueField": 'Положение наклонной камеры',
            "gradient": { 
              0.001: 'black',
              0.05: 'blue',
              0.25: 'cyan', 
              0.5: 'green', 
              0.75: 'yellow', 
              1: 'red'}
        });
        
        can_r7.setData(heatData);
        can_r13.setData(heatData);
        can_r14.setData(heatData);
        can16bitr12.setData(heatData);
        can16bitr15.setData(heatData);
        can8bitr18.setData(heatData);
        can8bitr26.setData(heatData);
        
        var mapControl = new L.Map('heatmapjs', {
            center: new L.LatLng(45.402376,41.217541),
            zoom: 15, 
            attributionControl: false,
            zoomControl: true,
            layers: [osm,esriSattelite,googleSattelite/*,yandexVector,yandexSatellite*/,can16bitr15]
            });

        L.control.scale({
          "imperial":false,
          "position":'bottomleft'
        }).addTo(mapControl);
        
        L.edgeScaleBar().addTo(mapControl);
        
        var baseLayers = {
          "OpenStreetMap": osm,
/*        
          "Яндекс - карты":yandexVector,
          "Яндекс - спутник":yandexSatellite,
*/
          "Esri world imagery": esriSattelite,
          "Google sattelite": googleSattelite,
        };
        
        
        
        var overlays = {
            "Наполненность бункера": can_r7,
            "Зазор решето нижнее": can_r13,
            "Зазор решето верхнее": can_r14,
            "Поток зерна": can16bitr12,
            "Влажность": can16bitr15,
            "Бункер": can8bitr18,
            "Положение наклонной камеры": can8bitr26,
            "Публичная кадастровая карта": cadastre
        };
        
        L.control.layers(baseLayers, overlays).addTo(mapControl);
        

        
        });
    </script>   
    <style type="text/css">
        html, body{
          width: 95%;
          height: 95%;
        }
        #heatmapjs {   
          width: 95%;
          height: 95%;
          padding: 10px;
          background-color: transparent;
          -webkit-border-radius: 4px;
          -moz-border-radius: 4px;
          border-radius: 4px;
        }
      
        .leaflet-control-scale-line {
          box-sizing: border-box;
        }
    </style>  
  </head>
  <body>
    <div class="header" id="header"><h1>Карта</h1></div>
    <div class="heatmapjs" id="heatmapjs"></div>
  </body>

</html>
