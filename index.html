<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8" />
    <title> </title>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" crossorigin="" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet-src.js" crossorigin=""></script>
<!-- wms -->
    <script src="https://heigeo.github.io/leaflet.wms/dist/leaflet.wms.js"></script>
<!-- pkk -->    
    <script src="https://originalsin.github.io/Leaflet.TileLayer.Rosreestr/src/TileLayer.Rosreestr.js"></script>    
<!-- scalebar -->
    <script src="https://geof-osgl.github.io/Leaflet.EdgeScaleBar/leaflet.edgescalebar.js"></script>
    <link rel="stylesheet" href="https://cdn.rawgit.com/ardhi/Leaflet.MousePosition/master/src/L.Control.MousePosition.css">    
<!-- heatmap js -->
    <!--script src="https://leaflet.github.io/Leaflet.heat/dist/leaflet-heat.js"></script-->
    <script src="https://www.patrick-wied.at/static/heatmapjs/assets/js/heatmap.min.js"></script>
    <script src="https://www.patrick-wied.at/static/heatmapjs/assets/js/leaflet-heatmap.js"></script>
<!-- heatmap data -->
    <script src="https://mappl.github.io/leaflet-heatmaps-test/heatmap_data.js"></script>
<!-- ya maps -->
    <!--script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&amp;apikey=75780e21-1d3e-4aa2-b14e-1a99a3f4e6d9" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-plugins/3.3.1/layer/tile/Yandex.min.js"
            integrity="sha512-aqdPFk64oMfp8X2hKeN1Oyg2+Pm4QE6wTEetP0Sq6hrFudc2WEKcxvTom5eoh8cIA3WToD3Tz9sz/+LfCfRz6g=="
            crossorigin="anonymous">
    </script-->
    
    <script>
      $( window ).on( "load", function() {
        
        var osm = L.tileLayer(
          'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
            attribution: '...',
            maxZoom: 18
          }
        );
        
        var esriSattelite = L.tileLayer(
          'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',{
            attribution: 'esri',
            maxZoom: 18
          }
        );
        
        var googleSattelite = L.tileLayer(
          'http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
            subdomains:['mt0','mt1','mt2','mt3']},{
            attribution: 'Google-Satellite',
            maxZoom: 18
          }
        );
        
       var cadastre = L.tileLayer.Rosreestr(
        'https://pkk.rosreestr.ru/arcgis/rest/services/PKK6/Cadastre/MapServer/export?layers%3Dshow%3A21&dpi=96&format=PNG32&bboxSR=102100&imageSR=102100&size=1024%2C1024&transparent=true&f=image&bbox={bbox}', {
          tileSize: 1024,
          attribution: 'Rosreestr'
       });        
/*        
        var yandexVector = L.yandex();     
        var yandexSatellite = L.yandex({ type: 'satellite' });
*/        
        var heatmap = new HeatmapOverlay({
            "radius": 5,
            "maxOpacity": .8,
            "scaleRadius": false,
            "useLocalExtrema": true,
            "latField": 'lat',
            "lngField": 'lng',
            "valueField": 'can16bitr15'
        });
        
        
        var mapControl = new L.Map('heatmapjs', {
            center: new L.LatLng(45.402376,41.217541),
            zoom: 15, 
            attributionControl: false,
            zoomControl: true,
            layers: [osm,esriSattelite,googleSattelite/*,yandexVector,yandexSatellite*/,heatmap]
            });

        heatmap.setData(testData);
        

        L.control.scale({
          "imperial":false,
          "position":'bottomleft'
        }).addTo(mapControl);
        

        var baseLayers = {
          "OpenStreetMap": osm,
/*        
          "Яндекс - карты":yandexVector,
          "Яндекс - спутник":yandexSatellite,
*/
          "Esri world imagery": esriSattelite,
          "Google sattelite": googleSattelite,
        };
        
        
        
        var overlays = {
            "heatmap:can16bitr15": heatmap,
            "Публичная кадастровая карта": cadastre
        };
        
        L.control.layers(baseLayers, overlays).addTo(mapControl);
        
        L.edgeScaleBar().addTo(mapControl);
        
        });
    </script>   
    <style type="text/css">
        html, body{
          width: 95%;
          height: 95%;
        }
        #heatmapjs {   
          width: 95%;
          height: 95%;
          padding: 10px;
          background-color: transparent;
          -webkit-border-radius: 4px;
          -moz-border-radius: 4px;
          border-radius: 4px;
        }
      
        .leaflet-control-scale-line {
          box-sizing: border-box;
        }
    </style>  
  </head>
  <body>
    <div class="header" id="header"><h1>It works!</h1></div>
    <div class="heatmapjs" id="heatmapjs"></div>
  </body>

</html>
